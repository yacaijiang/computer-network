计算机网络：根据规模
WAN 广域网
MAN 城域网
LAN 局域网

计算机与网络发展：
批处理、分时系统、计算机之间通信、计算机网络、互联网、互联网的发展、单纯连接到安全建立连接

协议就是计算机之间通过网络实现通信事先达成的“约定”。

分组交换协议：
大数据分割为一个个叫做包的较小单位进行传输的方法。

OSI参考模型：
将通信协议中的必要功能分为7层；
每一层接收下一层提供的特定服务，并为上一层提供特定服务。
同层之间交互遵循的约定叫做协议
上下层之间交互遵循的约定叫做接口

传输方式：

面向连接和面向无连接
面向连接：先在源主机和目标主机之间建立通信线路，再进行数据传输
面向无连接：无需建立通信线路，发送端可以随时发送数据，


网络通信方式主要有：

电路交换：
使用交换机负责数据中转处理，计算机首先被连接到交换机上。交换机和交换机之间由通信线路继续连接。
计算机发送数据时，需要通过交换机与目标主机建立通信电路，将连接电路称为建立连接。建立连接后，一会就可以一直使用这条电路直到连接断开。

分组交换协议：
使用分组交换机（路由器）连接通信线路。
发送端计算机将数据发送给路由器，路由器收到这些分组数据后，缓存到自己的缓冲区，然后再转发给目标计算机。
分组交换中，计算机与路由器之间以及路由器与路由器之间通常只有一条线路。

根据接收端数量分类：

单播：
一对一通信

广播：
一个主机发送给所有与之相连的其他主机。

多播：
多播限定某一组特定主机作为接收端

任播：
在特定主机中选取一台作为接收端

网卡：任一计算机连接网络，必须使用网卡。网卡又称网络适配器

中继器：物理层上延长网络的设备
把电缆传来的信号经由中继器波形调整和放大再传给另一个电缆

网桥/2层交换机
在数据链路层上连接两个网络的设备，能够识别数据链路层中的数据帧，并临时存储与内存，再生成信号作为全新的帧转发给相连另一个网段。
根据物理地址（MAC地址）进行处理

路由器/3层交换机
网络层上连接两个网络、并对分组报文进行转发的设备
根据IP地址进行处理

4~7层交换机负责处理OSI模型中从传输层之应用层的数据
以TCP等协议的传输以及上面应用层为基础，分析收发数据，并对其处理

网关：负责从传输层之应用层的数据进行转换和转发的设备

互联网：
TCP/IP协议是为使用互联网开发制定的协议簇，互联网的协议就是TCP/IP，
ISP：连接互联网需要向ISP或区域网提出申请

TCP/IP：
硬件（物理层）：最底层扶着数据传输的硬件

网络接口层（数据链路层）：利用以太网中的数据链路层进行通信，因此属于接口层；

互联网层（网络层）：使用IP协议，相当于OSI模型中的第三层网络层，
IP协议基于IP地址转发分包数据

IP是跨越网络传送数据包，使整个互联网都能收到数据的协议，

IP不具有重发机制，即使分组数据包未到达目标主机也不会重发，属于非可靠传输协议。

ICMP：当IP数据包未到达目标地址，需要给发送端发送一个异常通知，ICMP就是为此制定，有时也用来诊断网络的健康状况。

ARP：从分组数据包的IP地址中解析出物理地址的协议

传输层：
主要功能：实现应用程序之间的通信

TCP: 面向连接的传输层协议

UDP：面向无连接的传输层协议

应用层（会话层以上的分层）
TCP/IP应用的架构多属于：客户端/服务端模型

浏览器与服务端之间的通信使用的协议是HTTP，传输数据主要格式是HTML。

HTTP属于OSI应用层的协议，而HTML属于表示层的协议。

发送电子邮件的协议STMP

FTP 文本传输协议

远程登陆：TELNET 与SSH 协议

网络管理：SNMP

进行网络管理使用SNMP协议。使用SNMP管理的主机、网桥、路由器等称作SNMP代理
进行管理的那一段叫做管理器，SNMP就是这两个需要用到的协议。

在SNMP代理端存放网络接口信息、通信数据量、异常数据量以及设备温度等。
MIB可以访问以上数据。
SNMP属于应用协议、MIB属于表示层协议。


包：
帧：数据链路层中包的单位
数据包是：IP和UDP等网络层以上分层中的包的单位。
段：表示TCP数据流中的信息。
消息指应用协议中数据的单位。

网络中传输的数据包由两部分构成：一部分是协议使用的首部，另一部分是上层传过来的数据

发送数据包过程：

应用程序处理：
应用程序进行编码处理数据
应用在发送数据那一刻建立TCP连接，从而利用这个TCP连接发送数据。

TCP模块的处理：
TCP根据应用指示，负责建立连接发送数据以及断开连接
在应用层数据前端附加一个TCP首部：源端口号、目的端口号、序号（用以发送的包中哪部分是数据）以及校验和（用于判断数据是否损坏），
随后将加入了TCP首部的包在发送给IP；

IP模块的处理
在TCP数据收报前端再加上自己的IP首部。
IP首部中包含接收端IP地址和发送端IP地址，
紧随IP首部的还有判断数据是TCP还是UDP的信息。
IP包生成后，参考路由控制表决定接收IP包的路由或者主机，
随后将IP包发送给连接这些路由器或者主机网络接口的驱动程序，实现数据发送。
若不知道接收端MAC可以通过ARP查找。

网络接口（以太网驱动）的处理
将IP传过来的IP包附加以太网首部并发送，
以太网首部：接收端MAC地址、发送端MAC地址以及标志以太网类型的以太网数据的协议。
通过物理层传输给接收端。
FCS（Frame Check Sequence）为了判断数据包是否由于噪声而被破坏

经过数据链路层的包

接收数据包过程：

网络接口（以太网驱动）的处理
从首部找到MAC地址判断是否是给自己的，若不是则丢弃，
若是发给自己的，确定以太网协议传送过来的数据类型，此过程中发送的是IP包，
因此将数据传给上一层IP模块处理，若是其他协议如ARP，则传给ARP处理，若无法识别，丢弃该包。

IP模块的处理
判断得到的包首部中目的IP地址匹配，可接受数据并继续查找上一层协议。
如果上一层是TCP，即传给TCP处理，
若为UDP，则传给UDP处理。
对于有路由器的情况下，接收端往往不是自己的地址，此外需要借助路由控制表，找到应该送达的主机或者路由器再转发数据；

TCP模块的处理
 首先计算校验和，判断数据是否损坏，
 然后检查是否按照序号接收数据。
 最后检查端口号，确定具体的应用程序。
数据接收完毕后，接收端发送一个确认回执给发送端。
如果回执信息未到达发送端，发送端会因此一直反复发送数据。
数据完整接收后，传给端口号识别的应用程序。

应用程序的处理
接收端会直接接收该数据，分析数据并获取收件人地址，发送内容会被保存下来


数据链路：

数据链路的段是指一个被分割的网络。
引入中继器将两条网线相连组成一个网络。

网络连接和构成形态称为网络拓扑：
总线型、环形、星型、网状型

MAC地址：

用于识别数据链路中互连的节点。
IEEE802.3 无线lan（IEEE802.11a/b/n）使用MAC地址

MAC地址长48比特：
第一位：单播（0）/多播（1）
第二位：全局地址（0）/本地地址（1）
第3~24位：厂商识别码（由IEEE管理保证各厂家之间不重复）
第25~48位：厂商内识别码（由厂商自己管理保证产品之间不重复）

从通信介质的使用方法看，网络可分为共享介质型和非共享介质型

贡献介质型：最早的以太网和FDDI
半双工通信

两种介质访问控制方式：
争用方式：
指争夺获取数据传输的权力，也叫CSMA（载波监听多路访问）。
通过采用先到先得方式占用信道，若多个站同时发送帧，会冲突，导致网络拥堵。

CSMA/CD：
如果载波信道上无数据流，则任何站可以发送数据；
检查是否冲突，若出现冲突，立刻放弃发送数据，并释放载波信道。
放弃发送后，随机延时一段时间，再重新争用介质，发送帧。

令牌传递方式：

沿着令牌环发送一种叫做“令牌”的特殊报文，是控制传输的一种方式。
只有获得令牌的站才能发送数据。
不会产生冲突
每个站都有通过平等循环获得令牌的机会。

非共享介质型：s
不共享介质，每个站直链交换机，交换机负责转发数据帧。
全双工通信

该方式根据交换机的高级特性构建虚拟局域网、进行流量控制；
弱点：若交换机故障，与之相连的计算机之间无法通信


环路检测技术：

解决网络中环路问题：

生成树方式：
每个网桥必须在1-10秒内相互交换BPDU包，从而判断哪些端口使用哪些不使用，消除环路。
出现故障，则自动切换通信线路，利用那些没有被使用的端口继续进行传输。

源路由法：
判断发送数据的源地址是通过哪个网桥实现传输的，并将帧写入RIF。
网桥根据RIF信息发送帧给目标地址。
此方法中，发送端必须具备源路由功能


VLAN
交换机按照端口区分多个网段，从而区分了广播数据传播范围
减少网络负载、提高网络安全性。
异构的两个网段需要利用具有路由功能的交换机或者在各段中通过路由器连接实现通信



以太网：
计算机内部：
1K=1024
1M=1024K
1G=1024M
以太网中传输速率通过时钟频率决定：
1K=1000
1M=1000K
1G=1000M

以太网帧体格式：
目标MAC地址（6字节）源MAC地址（6字节）类型（2字节）数据（46-1500字节）FCS(4字节)
FCS（Frame Check Sequence）帧检验序列

无线通信：
IEEE802.11定义无线LAN协议中物理层与数据链路层的（MAC层）

传输层：TCP/UDP
网络层：IP
数据链路层：
LLE层： 802.2逻辑链路控制
MAC层： 802.11 MAC CSMA/CA 
物理层：802.11 802.11a/b/g/n

蓝牙：使用2，4GHz频率无线电波的标准，
Zigbee 用于家电的远程控制，短距离、低功耗的无线通信技术。

PPP指点对点，相当于区位OSI参考模型第二层的数据链路层
用于电话线、ISDN、专线、ATM线路

主要包含两个协议：
不依赖上层的LCP协议
依赖上层的NCP协议，当上层为IP，也称为IPCP

LCP:负责建立和断开连接，设置最大接收单元（MRU),设置验证协议（PAP\CHAP），设置是否进行通信质量监控
IPCP：负责IP地址设置以及是否进行TCP/IP首部压缩等

PAP:PPP连接建立时，通过两次握手进行用户名和密码验证
CHAP：使用一次性密码OTP,有效防止窃听

其他数据链路：

ATM：以一个叫做信元（5字节首部加48字节数据）的单位进行传输的数据链路
面向连接的数据链路，在通信前需要设置通信线路

POS: SDH上进行包通信的协议。SDH是在光纤上传输数字信号的物理层规范。

FDDI：分布式光纤数据接口：采用令牌环的访问方式。

Token Ring：令牌环网

100VG-AnyLAN

光纤通道：
实现高速数据通信的一种数据链路

HIPPI：用于超大型计算机传输

IEEE1394：面向家庭的局域网

HDMI：
iSCSI:个人电脑连接硬盘的SCSI标准应用于TCP/IP网络上
InfiniBand：针对高端服务器的超高速传输接口技术
DOCSIS：有线电视（CATV）传输数据的行业标准
高速PLC：利用电力线传输高频信号

公共网络：
模拟电话线路
移动通信服务
ADSL:对已有的模拟电话线路进行扩展的服务
FTTH：高速光纤直连到用户的方法
有线电视
专线
VPN：连接距离较远的地域
有IP-VPN和广域以太网
IP-VPN ：在IP网络（互联网）上建立VPN，在IP层面的连接
广域以太网：在作为数据链路层的以太网上利用VLAN实现VPN技术

公共无线LAN












IP协议：
网络层主要作用：实现终端节点之间的通信。
IP主要作用，在复杂网络环境中将数据包发给最终的目标地址

主机：配有IP地址，不进行路由控制
路由器：既有IP地址，有配有路由控制功能

IP主要作用模块：
IP寻址、路由、IP分包与组包

多跳路由：IP数据包在网络中一个跳间又一个跳间转发直到终点，跳（Hop）网络中一个区间；

路由控制表：记录IP数据下一步应该发给哪一个路由器

IP地址：网络地址+主机地址
A类：
首位：0，1-8位网络标识，后24位主机标识
B类：
前两位：“10”，1-16位网络标识，后16位主机标识
C类：
前三位：“110”，1-24位网络标识，后8位主机标识
D类：
前四位：“1110”，1-32位网络标识，无主机标识，用于多播

广播地址：
在同一链路中相互连接的主机之间发送数据包：
IP地址中的主机地址部分全部设置为1，成为了广播地址：
172.20.0.0/16 16：网络号为16位
192.168.0.0/24 24：网络号为24位

IP多播与地址
多播使用D类地址：若首位开始到第4位是“1110”就认为是多播地址
剩下的28位可以成为多播的组编号。

使用IP多播实现通信，除了地址还需要IGMP协议

子网掩码：IP地址网络标识部分位全为“1”，主机标识部分全为“0”；

CIDR：无类型域间选路， 采用任意长度分割IP地址的网络标识和主机标识
VLSM：可变长子网掩码，通过域间路由协议转换为RIP2以及OSPF实现。

私有IP和全局IP

NAT：公网IP

全局IP由ICANN管理

路由控制：
路由控制表中记录着网络地址与下一步应该发送到的路由器地址
发送IP包时，先确定IP包首部中的目标地址，从路由控制表中找到与该地址具有相同网络地址的记录
根据记录将IP包转发给下一个路由器。
如果路由控制表中存在多条相同网络地址的记录，则选择最吻合的网络地址

默认路由：
路由表中任意地址都能与之匹配
一般记作“0.0.0.0/0或者default”

主机路由：
IP地址/32 整个IP地址的所有位都将参与路由，
多用于不希望通过网络地址路由的情况
环回地址：
在同一台计算机的程序间通信时使用的默认地址：
计算机使用一个特殊的IP地址127.0.0.1作为i环回地址
具有相同意义的是叫localhost的主机名
使用次IP或者主机名时，数据包不会流向网络

路由控制表的聚合：
利用网络地址的比特分布可以有效的进行分层配置。


IP分割处理与再构成处理

路径MTU发现： 从发送端主机到接收端主机之间不需要分片时最大MTU大小。

IPv6：
地址为IPv4四倍：128bit 写成8个16位字节
IPv4 地址：32bit 写成4个8位字节

将120bitIP地址以每16bit为一组，每组用“：”隔开进行标记
如果出现连续0的时候，可以将这些0省略并用两个冒号“：：”隔开
一个IP地址中只允许出现一次两个连续的冒号

IPv6地址分类：

全局单播地址：
n=48,m=16, 128-48-16=64.前64bit网络标识，后64bit主机标识

n：全局路由前缀（广域网络）
m：子网ID（某站点内部）
剩余128-n-m bit：接口ID（主机标识）

链路本地单播地址：
指再同一数据链路内唯一地址

唯一本地地址：
指不进行互联网络通信时所使用的地址

IPv6分段处理：
只在发送端主机进行分片处理，路由器不参与分片。

IPv4首部
首部长度：4bit构成，表明首部大小，单位为4字节（32bit）

区分服务：8bit

DSCP(差分服务代码点)：6bit，TOS一部分，现在统称为DiffServ，用于进行质量控制

ECN（显式拥塞通告）：2bit，报告网络拥堵情况

总长度： 16bit，表示IP首部与数据合起来的总字节数 IP包最大长度为65535（=2^16）字节；

标识：16bit，用于分片重组，同一个分片的标识值相同，不同分片的标识值不同

标志：3bit 标识包被分片的信息

片偏移：13bit， 标识被分片的每一个分段对于原始数据的位置
第一个位置分片对应的值为0，做多可以表示8192（=2^13）个相对位置,单位八字节，即
最大可以表示原始数据8X8192=65536个字节的位置；

生存时间：8bit 最初以秒为单位记录当前包再网络上应该生存的期限。实际指可以中转多少个路由器。没经过一个路由器，生存时间减少1，直到变成0时丢弃该包。

协议：8bit 表示IP首部的下一个首部隶属于哪一个协议：
如： 0，HOPOPT; 1,ICMP; 2,IGMP; 4,IP; 6,TCP;17,UDP等；

首部校验和：16bit，只校验数据报的首部，不校验数据部分，确保IP数据报不会被破坏。
首先将所有位设为0，以16bit为单位划分IP首部，用1补数计算所有16位字的和，最后将所得的和和1补数赋给首部校验和字段

IP首部校验和的计算主要是两步：按位异或和取反，具体来说

对于发送方计算检验和：

1. 初始计算校验和字段时该字段全部用0填充；

2. IP头部以16位为一个单位，逐个模2加（相当于异或）；
3. 得到的结果取反，作为校验和放入校验和字段；

对于接收者来说，验证也很简单：

1. 对于接收的IP报文头部以16位为单位逐个求和；
2. 若结果为1，则校验正确，否则出错丢弃；

原理很简单，接收方的计算对象是A和A的反的异或，结果当然是1了！

例如：
  IP头：
  45 00    00 31
  89 F5    00 00
  6E 06    00 00（校验字段）
  DE B7   45 5D       ->    222.183.69.93   (源IP地址)
  C0 A8   00 DC       ->    192.168.0.220  (目的IP地址)
  计算：  
  4500 + 0031 +89F5 + 0000 + 6e06+0000 + DEB7 + 455D + C0A8 + 00DC =3 22C4 （结果大于4bit,继续迭代计算)
  0003 + 22C4 = 22C7 
  ~22C7 = DD38      ->即为应填充的校验和
  当接受到IP数据包时，要检查IP头是否正确，则对IP头进行检验，方法同上：
  计算：
  4500 + 0031 +89F5 + 0000 + 6E06+DD38 + DEB7 + 455D + C0A8 + 00DC =3 FFFC
  0003 + FFFC = FFFF
  得到的结果是全1，正确。

源地址：32bit，发送端IP地址；

目的地址：32bit，接收端IP地址；

可选项：长度不一定，通常只在进行实验或者诊断时使用，主要有：
安全级别、源路径、路径记录、时间戳

填充：由于首部长度不可能是32bit的整数倍，在此字段填充0，调整为32bit的整数倍。

数据：存入数据，包括IP上层协议的首部；


IP协议相关技术

DNS，在访问某网站时不使用IP地址，使用一串罗马数字和点组成的字符串。
域名：www.google.com为了识别主机名称和组织机构名称的一种具有分层的名称
DNS的分层叫做树形结构

DNS:域名服务器是指管理域名的主机和相应的软件，它可以管理所在分层的域的相关信息
所管理的分层叫做ZONE

根部设置的DNS叫做根域名服务器，对DNS的检索数据功能起着至关重要的作用。

为了提高容灾能力，一般会设置两个及以上域名服务器，一旦第一个域名服务器无法提供查询，
自动跳转至第二个甚至第三个域名服务器，进行灾备处理；

所有的域名服务器必须注册根域名服务器的IP地址， DNS根据IP地址进行检索时，从根域名服务器开始顺序进行

解析器：进行DNS查询的主机和软件叫做DNS解析器。一个解析器至少要注册一个以上域名服务器的IP地址
至少包括内部组织的域名服务器IP地址

DNS查询：
解析器为了调查IP地址，向域名服务器进行查询处理。接收这个查询请求的域名服务器首先会在自己的数据库进行查找。
如果有该域名所对应的IP地址就返回。
没有，再向上一层域名服务器进行查询处理，直到找到指定的域名服务器。

DNS管理的信息有：
主机与IP地址的对应信息叫A
IP地址检索主机名称的信息叫PTR
某一层域名服务器IP地址的映射叫NS

ARP： 
解决地址问题的协议，以目标IP地址为线索，定位下一个应该接收数据分包的网络设备对应的MAC地址。
如果目标主机不在同一个链路上面时，可以通过ARP查找下一跳路由器的MAC地址。
不适用IPv6

ARP协议借助ARP请求和ARP响应两种类型的包确定MAC地址。

主机A想获得主机B的MAC地址，首先通过广播发送一个ARP请求包，包内包含主机B的IP地址
在同一链路上所有主机或者路由器接收，如果B在链路上收到该包，将自己的MAC地址加入ARP响应包并返回给A

ARP协议与IP地址和MAC地址相关

RARP
从MAC地址定位IP地址的一种协议，如打印机服务器等小型嵌入式设备

代理ARP
通常ARP包会被路由器隔离，采用代理ARP的路由器可以将ARP请求转发至邻近网段

ICMP:确认IP包是否成功送达目标地址，通知在发送过程在IP包被丢弃的原因，改善网络设置等

ICMP消息分为：通知出错原因的错误信息和用于诊断的查询信息

主要的ICMP消息：

ICMP目标不可达：
IP路由器无法将IP数据包发送给目标地址时，会给发送端主机返回一个目标不可达的ICMP消息

ICMP重定向消息：
路由器发现发送端主机使用次优路径发送数据，会返回一个ICMP重定向消息给主机，消息内含最合适的路由信息和源数据；
容易引发问题，一般不进行该设置

ICMP超时消息
当IP包中是TTL变为0时，IP包被丢弃，路由器发送ICMP超时消息给发送端主机；

ICMP回送消息
用于进行通信的主机或路由之间，判断所发送数据包是否已经成功到达的消息。可以向接收端发送回送请求消息，也可以接收接收端主机发来的回送应答消息。
Ping命令就是利用该消息实现的

ICMP原点抑制消息
低速广域网上容易发生网络拥堵
当路由器向低速线路发送数据时，其发送队列的缓存变为零而无法发送出去时，可以向 IP 包的源地址发送一个 ICMP 原点抑制消息。
收到这个消息的主机借此了解在整个线路的某一处发生了拥堵的情况，从而增大 IP 包的传输间隔，减少网络拥堵的情况。
然而，由于这种 ICMP 可能会引起不公平的网络通信，一般不被使用。

ICMP路由器探索消息
用于发现与自己相连的网络中的路由器，
当主机发出ICMP路由器请求消息时，路由器则返回ICMP路由器公告消息给主机

ICMP地址掩码消息
用于主机或者路由器想要了解子网掩码的情况，
向目标主机或者路由去发送ICMP地址掩码请求消息，
接收ICMP地址掩码应答消息获取子网掩码信息

ICMPv6
在IPv4中，即使没有ICMP也可以实现IP通信
在IPv6中，从IP地址定位MAC地址的协议变成ICMP的邻居探索消息
ICMPv6 将ICMP分为：错误消息，信息消息


DHCP
为了实现自动设置IP地址，统一管理IP地址分配，产生了DHCP协议。
机制：
首先架设一台DHCP服务器，然后将DHCP要分配的IP地址设置到服务器上。
若DHCP服务器遇到故障，将无法自动分配IP地址，从而导致网段内所有主机之间无法进行TCP/IP通信。
一般会使用两台机以上的DHCP服务器。
为了检查所有分配的IP地址以及已经分配的IP地址是否可用
DHCP服务器：
在分配IP地址前发送ICMP回送请求包，确认没有返回应答
DHCP客户端：
针对从DHCP服务器获得的IP地址发送ARP请求包，确认没有返回应答

DHCP中继代理
家庭网络大多只有一个以太网的网段
在企业或者学校内，一般会有多个网段，若针对每个网段都设置DHCP服务器将会是个庞大的工程。
可以通过DHCP中继代理结合一个DHCP服务器统一管理IP地址分配。
实现方式：
客户端向DHCP中继代理发送DHCP请求包，DHCP中继代理单播方式发送给DHCP服务器
服务器收到包发送返回应答给DHCP中继代理，DHCP中继代理再转发给客户端。

NAT：是用于再本地网络中使用私有地址，再连接互联网时转而使用全局IP地址的技术。
NAPT实现转换TCP、UDP端口号的技术；

当本地IP地址为10.0.0.10的某主机想和163.221.120.9的主机通信时，
NAT路由器先将发送源地址从10.0.0.10转换为全局IP地址202.222.123.32再发送数据
接收时也类似该过程，NAT将IP地址再转换为本地的IP地址后再进行转发。

NAT-PT：
许多互联网服务基于IPv4，为了使这些服务可以在IPv6中使用，产生了NAT-PT规范，
将IPv6首部转换为IPv4首部的技术

NAT存在的问题：
NAT(NAPT)依赖于自己的转换表：
无法从NAT外部向内部服务器建立连接；
转换表的生成与转换操作都会产生开销
通信过程中一旦NAT异常重启时，所有TCP连接都将重置
即使备置两台NAT做容灾备份，TCP连接还是会被断开。

解决方法：
转用IPv6，则所有设备都可以配置一个全局IP地址

用户忽略NAT的存在进行通信：在NAT内的主机运行的应用为了生成NAT转换表，先发送一个虚拟的网络包给NAT外侧
而NAT并不知道这个包是什么，正常读取包首部生成转换表，如果转换表结构合理，也可以实现NAT外侧的主机与内的主机建立连接进行通信
这种现象叫做“NAT穿越”

IP隧道：

网络A、B使用IPv6，若中间网络C支持IPv4，则A、B无法直接通信，需要通过IP隧道完成通信

IP隧道将A发过来的IPv6包加入一个IPv4后再发给C
即网络层首部后面继续追加网络层首部的通信方法叫做：IP隧道

IP多播相关技术：
MLD：多播监听发现；确认是否存在接收端

IGMP主要作用：
向路由器表明想要接收多播消息（并通知想接收多播的地址）
向交换集线器通知想要接受多播的地址

IP任播：
为那些提供同一种服务的服务器配置同一个IP地址，并且与最近的服务器通信的方法
DNS根域名服务器



TCP/UDP
TCP主要用于在传输层有必要实现可靠传输的情况。
UDP主要用于对高速传输和实时性有较高要求的通信或者广播通信
Socket（套接字）：应用程序利用套接字，可以设置对端的IP地址、端口号、实现数据接受和发送。


端口号：
数据链路中的地址MAC地址，识别同一链路中的不同计算机。
IP地址原来识别TCP/IP网络中互联的主机和路由器。
传输层中类似于地址的叫做端口号，识别同一台计算机中的不同语应用程序。

TCP/IP UDP/IP通信中：源IP地址、目标IP地址、协议号、源端口号、目标端口号
端口号确定：
标准既定的端口号：分布在1024`49151
时序分配法:49152~65535

UDP：面向无连接的传输层协议
不提供复杂的控制机制，利用IP提供面向无连接的通信服务
用于：
包总量比较少的通信（DNS、SNMP）
视频，音频等多媒体通信（即时通信）
现定于LAN等特定网络中的应用通信
广播通信（广播、多播）

TCP：充分实现数据传输时的控制功能。
连接：各种设备、线路、或者网络中进行通信的两个应用程序为了互相传递消息而专有的、虚拟的通信线路，也叫虚拟电路。
三次握手建立连接、四次握手断开连接：

发送端                        服务端
SYN（请求建立连接）
                          ACK(针对SYN的确认应答)+SYN（请求建立连接）
ACK（针对SYN确认应答）

                进行  数据传输
FIN(请求断开连接)
                          ACK（针对FIN的确认应答）
                          FIN（请求断开连接）
ACK（针对FIN的确认应答）

建立TCP连接时科研确定发送数据包的单位，称为MSS（最大消息长度）
TCP在传输数据时，以MSS大小将数据分割进行发送。
MSS实在三次握手的时候，两端主机计算得出。
建立连接请求时会在TCP首部中写入MSS选项，告知对方自己可接受的MSS大小，选择较小值使用

TCP每发送一个段，会进行一次确认应答处理，引入窗口解决该问题
窗口使用大量缓冲区，通过对多个段同时进行确认应答的功能。

高速重发控制：
当某一段报文丢失后，同一个序号的确认帧会不断重复返回，若发送端如果连续3次收到同一个确认帧，就会重发对应的数据。

流控制：
接收端向发送端主机通知自己科研接收数据的大小，于是发送端会发生不超过中国限度的数据，这个限度又叫做窗口大小。

TCP首部中专门有一个字段用于通知窗口大小

TCP流量控制，发送数据的同时，接收端会实时提供当前可以接受的窗口大小，发送端根据提示控制发送数据量。

慢启动：正常发送时若突然发送一个较大的数据量可能会导致网络拥堵，使用慢启动方法控制发送量。

拥塞控制：
定义了拥塞窗口，在慢启动时，将这个拥塞窗口设置为1个数据段，，之后每收到一次确认帧，拥塞窗口值加1
在发生数据包时，比较拥塞窗口和接收端窗口大小，选择小的发送。
随着包的往返，拥塞窗口也在不断增长，即会引发网络拥塞，
为了防止该情况，引入慢启动阈值，只要拥塞窗口的值超出这个阈值，每收到一次确认帧，允许以下比例放大:
1个数据段的字节数/拥塞窗口（字节） X 1个数据段的字节数

Nagle算法：
两个条件：
已发送数据都已经收到确认帧
可以发送最大段长度的数据
发送端即使还有应该发送的数据，如果不满足上述所有条件，进行延时发送的机制。

UDP-Lite（轻量级用户数据报协议）
SCTP（流控制传输协议）
DCCP（数据报拥塞控制协议）

UDP首部：
源端口号： 16bit。
目标端口号： 16bit。
包长度：保存UDP首部的长度和数据的长度之和 单位字节
校验和：

TCP首部：
源端口号：16bit
目的端口号：16bit
序列号： 32bit，发送数据的位置，每发送一次数据，会累加一次该数据字节数的大小
确认应答号： 32bit 下一次应该收到的数据序列号
数据偏移：4bit 单位4字节
保留：4bit
控制位：8bit
CWR:与ECE用于IP首部的ECN字段
ECE：置1时，从对方到这里的网络有拥塞
URG：置1时，表示包中有需要紧急处理的数据
ACK：置1时，确认应答的字段为有效的
PSH：置1时，表示需要将手段的数据立刻传给上层应用协议
RST：置1时，TCP连接异常需要强制断开连接
SYN：置1时，表示希望建立连接
FIN：置1时，表示断开连接
窗口大小：16bit通知可以接收的数据大小
校验和：16bit
紧急指针:16bit 在URG置1，该字段数值表示文段中紧急数据的指针
选项：用于提高TCP传输性能

路由协议

互联网由路由器连接的网络组合成的。
路由控制，控制数据包向正确的方向转发
路由控制表：路由器通过它转发数据

路由控制分：静态和动态

自治系统：在一个或者多个网络群体中采用的小型单位叫做自治系统AS或者路由选择域
如：ISP（互联网服务提供商）、区域网络

自治系统内部采用域内路由协议IGP
外部采用域间路由协议EGP

路由算法：
距离向量算法：根据距离（代价）和方向决定目标网络或者目标主机位置的一种方法。
链路状态算法：路由器在了解网络整体连接状态的基础上生成路由控制表的方法。每个路由器必须保持相同的信息才能进行正确的路由选择。

RIP：距离向量型的路由协议，用于LAN
将路由控制信息定期向全网广播，如果没有收到路由控制信息就断开连接。
距离单位为“跳数”，跳数指所经过的路由器个数。

RIP2：
使用多播、支持子网掩码、路由选择域、外部路由标志、身份验证密钥

OSPF
采用链路状态类型的路由协议
路由器之间交换链路状态生成网络拓扑信息，根据拓扑信息生成路由控制表
OSPF给每一条链路赋予一个权重，并始终选择一个权重最小的路径作为最终路由。
RIP选择路由器个数最少的路径，OSPF选择总代价较小的路径。

OSPF中，连接到同一个链路的路由器称作相邻路由器
OSPF中，5种类型包：
问候（HELLO)、数据库描述、链路状态请求、链路状态更新、链路状态确认应答

网络LSA以网络为中心生成的信息，表示网络与哪些路由器相连接
路由器LSA以路由器为中心生成信息，表示这个路由器与哪些网络相连接。

OSPF为了减少计算负荷，引入区域
区域：连接在一起的网络和主机划分成小组，使一个自治系统AS内可以拥有多个区域
具有多个区域的自治系统必须要有一个主干区域，且所有其他区域必须都与这个主干区域相连接。
区域边界路由器：连接区域与主干区域的路由器
内部路由器：区域内部的路由器
主干路由器：只与主干区域内连接的路由器
AS边界路由器：与外部相连接的路由器

BGP：边界网关协议连接不同组织机构（不同的自治系统）的协议
属于外部网关协议EGP，主要用于ISP之间连接部分
BGP属于路径向量型协议，路径向量型可以检测出环路，避免无线计数问题，支持策略路由。
策略路由控制：在发送数据包时，可以选择或者指定要通过的AS

MIPS：转发IP数据包可以使用路由技术外，还在使用标记交换技术。
标记交换对每一个IP包都设定一个叫做”标记“的值，然后根据这个标记再进行转发。
LSP：标记交换路由器：实现MIPS功能的路由器
与外网连接的那部分LSR叫做标记边缘路由器（LER）
优点：转发速度快、利用标记生成虚拟路径，并在它上面实现IP等数据包的通信


应用协议：：
为了实现某种应用而设计和创造的协议。

远程登陆：TELNET和SSH两种协议
TELNET：利用TCP的一条连接向主机发送文字命令并在主机上执行。
两类基本服务：仿真终端功能、协商选项机制
SSH：加密的远程登陆系统

文件传输：
FTP是在两个相连的计算机之间进行文件传输时使用的协议
通过两条TCP连接：一条用于控制，一条进行数据传输
用于控制的TCP连接主要在FTP的控制部分使用，所使用的TCP 21端口号。
通常，用于数据传输的TCP连接是与控制用的连接相反方法建立
一般，数据传输用的TCP连接常用端口号20

电子邮件：
SMTP在传输层使用TCP协议
电子邮件：邮件地址、数据格式、发送协议
邮件地址：使用电子邮件需要拥有的地址
MIME：所发送数据类型扩展到MIME
由首部和正文组成，
SMTP使用TCP的25号端口
POP:用于接收电子邮件的协议
IMAP：接收电子邮件协议，POP中邮件由客户端进行管理，在IMAP中邮件由服务器进行管理

SNMP：用于TCP/IP网络管理中收集必要信息，基于UDP/IP的协议
SNMP中管理端叫做管理器，被管理端叫做代理
MIB：SNMP中交互的信息，在树形结构的数据库中为每一个项目附加编号的信息结构。
MIB相当于SNMP的表示层。
RMON


网络安全

防火墙：组织机构（域）内部的网络与互联网相连时，为了避免域内受到非法访问的威胁，往往会设置防火墙。
建立TCP连接的请求只允许从内网发起。

IDS入侵检测系统：
DMZ非军事化区：再连接互联网的网络中，设置一个服务器并在该服务器上建立一个允许从互联网直进进行通信的专用子网。

反病毒/个人防火墙：用户使用的计算机或者服务器上运行的软件。

加密技术：
加密：利用某个值（密钥）对明文数据通过一定的算法变成加密数据的过程，逆过程叫做解密
对称加密方式：加密和解密使用相同的密钥：AES、DES
公钥加密方式：加密和解密分别使用不同的密钥（公钥和私钥）：RSA、DH、椭圆曲线

身份认证技术：
根据所知道的信息进行认证：
使用密码或者私有代码（识别码）的方式。
根据所拥有的信息进行认证：
利用ID卡、密钥、电子证书、电话号码等信息的方式。
根据独一无二的体态特征进行认证：
根据指纹、视网膜等个人特有生物特征进行认证。


安全协议：
IPsec：在IP首部后面追加ESP(封装安全有效载荷)和AH(认证首部)，从而对此后数据进行加密，不被盗取者轻易解读
VPN上使用IPsec

TLS/SSL：web中通过TLS/SSL对HTTP通信进行加密，
HTTPS：使用TLS/SSL的HTTP通信
使用对称加密方式。

IEEE802.1X:为了能够接入LAN交换机和无线LAN接入点而对用户进行认证的技术
只允许被认可的设备访问网络。
